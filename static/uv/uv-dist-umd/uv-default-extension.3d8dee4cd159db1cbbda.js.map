{"version":3,"sources":["webpack://UV/./src/extensions/uv-default-extension/Extension.ts","webpack://UV/./src/extensions/uv-default-extension/SettingsDialogue.ts","webpack://UV/./src/extensions/uv-default-extension/ShareDialogue.ts","webpack://UV/./src/modules/uv-dialogues-module/HelpDialogue.ts","webpack://UV/./src/modules/uv-filelinkcenterpanel-module/FileLinkCenterPanel.ts","webpack://UV/./src/modules/uv-resourcesleftpanel-module/ResourcesLeftPanel.ts","webpack://UV/./src/modules/uv-resourcesleftpanel-module/ThumbsView.ts"],"names":[],"mappings":"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AACU;AACd;AACK;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sDAAU;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA,4BAA4B,wDAAW;AACvC;AACA,+BAA+B,mDAAK;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iEAAgB;AAClD,qCAAqC,iEAAgB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,uEAAU;AACzC;AACA;AACA;AACA,+BAA+B,uEAAU;AACzC;AACA;AACA;AACA,+BAA+B,uEAAU;AACzC;AACA;AACA;AACA,+BAA+B,uEAAU;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,qEAAS;AACmB;;;;;;;;;;;;;ACtI9B;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACuE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,uEAAQ;AACY","file":"uv-default-extension.3d8dee4cd159db1cbbda.js","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { BaseEvents } from \"../../modules/uv-shared-module/BaseEvents\";\nimport { BaseExtension } from \"../../modules/uv-shared-module/BaseExtension\";\nimport { FileLinkCenterPanel } from \"../../modules/uv-filelinkcenterpanel-module/FileLinkCenterPanel\";\nimport { FooterPanel } from \"../../modules/uv-shared-module/FooterPanel\";\nimport { HeaderPanel } from \"../../modules/uv-shared-module/HeaderPanel\";\nimport { HelpDialogue } from \"../../modules/uv-dialogues-module/HelpDialogue\";\nimport { MoreInfoRightPanel } from \"../../modules/uv-moreinforightpanel-module/MoreInfoRightPanel\";\nimport { ResourcesLeftPanel } from \"../../modules/uv-resourcesleftpanel-module/ResourcesLeftPanel\";\nimport { SettingsDialogue } from \"./SettingsDialogue\";\nimport { ShareDialogue } from \"./ShareDialogue\";\nimport { Bools, Strings } from \"@edsilv/utils\";\nvar Extension = /** @class */ (function (_super) {\n    __extends(Extension, _super);\n    function Extension() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Extension.prototype.create = function () {\n        var _this = this;\n        _super.prototype.create.call(this);\n        // listen for mediaelement enter/exit fullscreen events.\n        $(window).bind(\"enterfullscreen\", function () {\n            _this.component.publish(BaseEvents.TOGGLE_FULLSCREEN);\n        });\n        $(window).bind(\"exitfullscreen\", function () {\n            _this.component.publish(BaseEvents.TOGGLE_FULLSCREEN);\n        });\n        this.component.subscribe(BaseEvents.CANVAS_INDEX_CHANGED, function (canvasIndex) {\n            _this.viewCanvas(canvasIndex);\n        });\n        this.component.subscribe(BaseEvents.THUMB_SELECTED, function (canvasIndex) {\n            _this.component.publish(BaseEvents.CANVAS_INDEX_CHANGED, canvasIndex);\n        });\n    };\n    Extension.prototype.createModules = function () {\n        _super.prototype.createModules.call(this);\n        if (this.isHeaderPanelEnabled()) {\n            this.headerPanel = new HeaderPanel(this.shell.$headerPanel);\n        }\n        else {\n            this.shell.$headerPanel.hide();\n        }\n        if (this.isLeftPanelEnabled()) {\n            this.leftPanel = new ResourcesLeftPanel(this.shell.$leftPanel);\n        }\n        this.centerPanel = new FileLinkCenterPanel(this.shell.$centerPanel);\n        if (this.isRightPanelEnabled()) {\n            this.rightPanel = new MoreInfoRightPanel(this.shell.$rightPanel);\n        }\n        if (this.isFooterPanelEnabled()) {\n            this.footerPanel = new FooterPanel(this.shell.$footerPanel);\n        }\n        else {\n            this.shell.$footerPanel.hide();\n        }\n        this.$helpDialogue = $('<div class=\"overlay help\" aria-hidden=\"true\"></div>');\n        this.shell.$overlays.append(this.$helpDialogue);\n        this.helpDialogue = new HelpDialogue(this.$helpDialogue);\n        this.$shareDialogue = $('<div class=\"overlay share\" aria-hidden=\"true\"></div>');\n        this.shell.$overlays.append(this.$shareDialogue);\n        this.shareDialogue = new ShareDialogue(this.$shareDialogue);\n        this.$settingsDialogue = $('<div class=\"overlay settings\" aria-hidden=\"true\"></div>');\n        this.shell.$overlays.append(this.$settingsDialogue);\n        this.settingsDialogue = new SettingsDialogue(this.$settingsDialogue);\n        if (this.isLeftPanelEnabled()) {\n            this.leftPanel.init();\n        }\n        if (this.isRightPanelEnabled()) {\n            this.rightPanel.init();\n        }\n    };\n    Extension.prototype.render = function () {\n        _super.prototype.render.call(this);\n    };\n    Extension.prototype.isLeftPanelEnabled = function () {\n        return (Bools.getBool(this.data.config.options.leftPanelEnabled, true) &&\n            (this.helper.isMultiCanvas() ||\n                this.helper.isMultiSequence() ||\n                this.helper.hasResources()));\n    };\n    Extension.prototype.getEmbedScript = function (template, width, height) {\n        //const configUri: string = this.data.config.uri || '';\n        //const script: string = String.format(template, this.getSerializedLocales(), configUri, this.helper.manifestUri, this.helper.collectionIndex, this.helper.manifestIndex, this.helper.sequenceIndex, this.helper.canvasIndex, width, height, this.data.embedScriptUri);\n        var appUri = this.getAppUri();\n        var iframeSrc = appUri + \"#?manifest=\" + this.helper.manifestUri + \"&c=\" + this.helper.collectionIndex + \"&m=\" + this.helper.manifestIndex + \"&s=\" + this.helper.sequenceIndex + \"&cv=\" + this.helper.canvasIndex;\n        var script = Strings.format(template, iframeSrc, width.toString(), height.toString());\n        return script;\n    };\n    return Extension;\n}(BaseExtension));\nexport default Extension;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { SettingsDialogue as BaseSettingsDialogue } from \"../../modules/uv-dialogues-module/SettingsDialogue\";\nvar SettingsDialogue = /** @class */ (function (_super) {\n    __extends(SettingsDialogue, _super);\n    function SettingsDialogue($element) {\n        return _super.call(this, $element) || this;\n    }\n    SettingsDialogue.prototype.create = function () {\n        this.setConfig(\"settingsDialogue\");\n        _super.prototype.create.call(this);\n    };\n    return SettingsDialogue;\n}(BaseSettingsDialogue));\nexport { SettingsDialogue };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ShareDialogue as BaseShareDialogue } from \"../../modules/uv-dialogues-module/ShareDialogue\";\nvar ShareDialogue = /** @class */ (function (_super) {\n    __extends(ShareDialogue, _super);\n    function ShareDialogue($element) {\n        return _super.call(this, $element) || this;\n    }\n    ShareDialogue.prototype.create = function () {\n        this.setConfig(\"shareDialogue\");\n        _super.prototype.create.call(this);\n    };\n    ShareDialogue.prototype.update = function () {\n        _super.prototype.update.call(this);\n        this.code = this.extension.getEmbedScript(this.options.embedTemplate, this.currentWidth, this.currentHeight);\n        this.$code.val(this.code);\n    };\n    ShareDialogue.prototype.resize = function () {\n        _super.prototype.resize.call(this);\n    };\n    return ShareDialogue;\n}(BaseShareDialogue));\nexport { ShareDialogue };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { BaseEvents } from \"../uv-shared-module/BaseEvents\";\nimport { Dialogue } from \"../uv-shared-module/Dialogue\";\nvar HelpDialogue = /** @class */ (function (_super) {\n    __extends(HelpDialogue, _super);\n    function HelpDialogue($element) {\n        return _super.call(this, $element) || this;\n    }\n    HelpDialogue.prototype.create = function () {\n        var _this = this;\n        this.setConfig(\"helpDialogue\");\n        _super.prototype.create.call(this);\n        this.openCommand = BaseEvents.SHOW_HELP_DIALOGUE;\n        this.closeCommand = BaseEvents.HIDE_HELP_DIALOGUE;\n        this.component.subscribe(this.openCommand, function () {\n            _this.open();\n        });\n        this.component.subscribe(this.closeCommand, function () {\n            _this.close();\n        });\n        this.$title = $(\"<h1></h1>\");\n        this.$content.append(this.$title);\n        this.$scroll = $('<div class=\"scroll\"></div>');\n        this.$content.append(this.$scroll);\n        this.$message = $(\"<p></p>\");\n        this.$scroll.append(this.$message);\n        // initialise ui.\n        this.$title.text(this.content.title);\n        this.$message.html(this.content.text);\n        // ensure anchor tags link to _blank.\n        this.$message.targetBlank();\n        this.$element.hide();\n    };\n    HelpDialogue.prototype.resize = function () {\n        _super.prototype.resize.call(this);\n    };\n    return HelpDialogue;\n}(Dialogue));\nexport { HelpDialogue };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { BaseEvents } from \"../uv-shared-module/BaseEvents\";\nimport { CenterPanel } from \"../uv-shared-module/CenterPanel\";\nimport { sanitize } from \"../../Utils\";\nimport { LanguageMap } from \"manifesto.js\";\nvar FileLinkCenterPanel = /** @class */ (function (_super) {\n    __extends(FileLinkCenterPanel, _super);\n    function FileLinkCenterPanel($element) {\n        return _super.call(this, $element) || this;\n    }\n    FileLinkCenterPanel.prototype.create = function () {\n        var _this = this;\n        this.setConfig(\"fileLinkCenterPanel\");\n        _super.prototype.create.call(this);\n        this.component.subscribe(BaseEvents.OPEN_EXTERNAL_RESOURCE, function (resources) {\n            _this.openMedia(resources);\n        });\n        this.$scroll = $('<div class=\"scroll\"></div>');\n        this.$content.append(this.$scroll);\n        this.$downloadItems = $(\"<ol></ol>\");\n        this.$scroll.append(this.$downloadItems);\n        this.$downloadItemTemplate = $('<li><img/><div class=\"col2\"><a class=\"filename\" target=\"_blank\" download=\"\"></a><span class=\"label\"></span><a class=\"description\" target=\"_blank\" download=\"\"></a></div></li>');\n        this.title = this.extension.helper.getLabel();\n    };\n    FileLinkCenterPanel.prototype.openMedia = function (resources) {\n        return __awaiter(this, void 0, void 0, function () {\n            var canvas, annotations, $item, i, annotation, $fileName, $label, $thumb, $description, annotationBody, id, label, thumbnail, description;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.extension.getExternalResources(resources)];\n                    case 1:\n                        _a.sent();\n                        canvas = this.extension.helper.getCurrentCanvas();\n                        annotations = canvas.getContent();\n                        for (i = 0; i < annotations.length; i++) {\n                            annotation = annotations[i];\n                            if (!annotation.getBody().length) {\n                                continue;\n                            }\n                            $item = this.$downloadItemTemplate.clone();\n                            $fileName = $item.find(\".filename\");\n                            $label = $item.find(\".label\");\n                            $thumb = $item.find(\"img\");\n                            $description = $item.find(\".description\");\n                            annotationBody = annotation.getBody()[0];\n                            id = annotationBody.getProperty(\"id\");\n                            if (id) {\n                                $fileName.prop(\"href\", id);\n                                $fileName.text(id.substr(id.lastIndexOf(\"/\") + 1));\n                            }\n                            label = LanguageMap.getValue(annotationBody.getLabel());\n                            if (label) {\n                                $label.text(sanitize(label));\n                            }\n                            thumbnail = annotation.getProperty(\"thumbnail\");\n                            if (thumbnail) {\n                                $thumb.prop(\"src\", thumbnail);\n                            }\n                            else {\n                                $thumb.hide();\n                            }\n                            description = annotationBody.getProperty(\"description\");\n                            if (description) {\n                                $description.text(sanitize(description));\n                                if (id) {\n                                    $description.prop(\"href\", id);\n                                }\n                            }\n                            this.$downloadItems.append($item);\n                        }\n                        this.component.publish(BaseEvents.OPENED_MEDIA);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    FileLinkCenterPanel.prototype.resize = function () {\n        _super.prototype.resize.call(this);\n        if (this.title) {\n            this.$title.text(sanitize(this.title));\n        }\n        this.$scroll.height(this.$content.height() - this.$scroll.verticalMargins());\n    };\n    return FileLinkCenterPanel;\n}(CenterPanel));\nexport { FileLinkCenterPanel };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { BaseEvents } from \"../uv-shared-module/BaseEvents\";\nimport { LeftPanel } from \"../uv-shared-module/LeftPanel\";\nimport { ThumbsView } from \"./ThumbsView\";\nimport { ViewingDirection } from \"@iiif/vocabulary\";\nimport { Files } from \"@edsilv/utils\";\nimport { LanguageMap } from \"manifesto.js\";\nvar ResourcesLeftPanel = /** @class */ (function (_super) {\n    __extends(ResourcesLeftPanel, _super);\n    function ResourcesLeftPanel($element) {\n        return _super.call(this, $element) || this;\n    }\n    ResourcesLeftPanel.prototype.create = function () {\n        this.setConfig(\"resourcesLeftPanel\");\n        _super.prototype.create.call(this);\n        this.setTitle(this.content.title);\n        /*\n             TODO: make tabs work\n            this.$tabs = $('<div class=\"tabs\"></div>');\n            this.$main.append(this.$tabs);\n    \n            this.$thumbsButton = $('<a class=\"thumbs tab\">' + this.content.thumbnails + '</a>');\n            this.$thumbsButton.prop('title', this.content.thumbnails);\n            this.$tabs.append(this.$thumbsButton);\n    \n            this.$resourcesButton = $('<a class=\"resources tab\">' + this.content.resources+ '</a>');\n            this.$resourcesButton.prop('title', this.content.resources);\n            this.$tabs.append(this.$resourcesButton);\n             */\n        this.$tabsContent = $('<div class=\"tabsContent\"></div>');\n        this.$main.append(this.$tabsContent);\n        this.$views = $('<div class=\"views\"></div>');\n        this.$tabsContent.append(this.$views);\n        this.$thumbsView = $('<div class=\"thumbsView\"></div>');\n        this.$views.append(this.$thumbsView);\n        this.$resourcesView = $('<div class=\"resourcesView\"></div>');\n        this.$resources = $(\"<ul></ul>\");\n        this.$resourcesView.append(this.$resources);\n        this.$views.append(this.$resourcesView);\n        this.thumbsView = new ThumbsView(this.$thumbsView);\n        this.dataBind();\n    };\n    ResourcesLeftPanel.prototype.dataBind = function () {\n        this.dataBindThumbsView();\n        var annotations = this.extension.helper\n            .getCurrentCanvas()\n            .getResources();\n        if (annotations.length === 0) {\n            this.$resourcesView.hide();\n        }\n        for (var i = 0; i < annotations.length; i++) {\n            var annotation = annotations[i];\n            var resource = annotation.getResource();\n            if (resource) {\n                var label = LanguageMap.getValue(resource.getLabel());\n                if (label) {\n                    var mime = Files.simplifyMimeType(resource.getFormat().toString());\n                    var $listItem = $('<li><a href=\"' +\n                        resource.id +\n                        '\" target=\"_blank\">' +\n                        label +\n                        \" (\" +\n                        mime +\n                        \")\" +\n                        \"</li>\");\n                    this.$resources.append($listItem);\n                }\n            }\n        }\n    };\n    ResourcesLeftPanel.prototype.dataBindThumbsView = function () {\n        if (!this.thumbsView)\n            return;\n        var width;\n        var height;\n        var viewingDirection = this.extension.helper.getViewingDirection();\n        if (viewingDirection &&\n            (viewingDirection === ViewingDirection.LEFT_TO_RIGHT ||\n                viewingDirection === ViewingDirection.RIGHT_TO_LEFT)) {\n            width = this.config.options.twoColThumbWidth;\n            height = this.config.options.twoColThumbHeight;\n        }\n        else {\n            width = this.config.options.oneColThumbWidth;\n            height = this.config.options.oneColThumbHeight;\n        }\n        if (typeof width === \"undefined\") {\n            width = 100;\n        }\n        if (typeof height === \"undefined\") {\n            height = 100;\n        }\n        this.thumbsView.thumbs = this.extension.helper.getThumbs(width, height);\n        // hide thumb selector for single-part manifests\n        if (this.thumbsView.thumbs.length < 2) {\n            this.$thumbsView.hide();\n        }\n        this.thumbsView.databind();\n    };\n    ResourcesLeftPanel.prototype.expandFullStart = function () {\n        _super.prototype.expandFullStart.call(this);\n        this.component.publish(BaseEvents.LEFTPANEL_EXPAND_FULL_START);\n    };\n    ResourcesLeftPanel.prototype.expandFullFinish = function () {\n        _super.prototype.expandFullFinish.call(this);\n        this.component.publish(BaseEvents.LEFTPANEL_EXPAND_FULL_FINISH);\n    };\n    ResourcesLeftPanel.prototype.collapseFullStart = function () {\n        _super.prototype.collapseFullStart.call(this);\n        this.component.publish(BaseEvents.LEFTPANEL_COLLAPSE_FULL_START);\n    };\n    ResourcesLeftPanel.prototype.collapseFullFinish = function () {\n        _super.prototype.collapseFullFinish.call(this);\n        this.component.publish(BaseEvents.LEFTPANEL_COLLAPSE_FULL_FINISH);\n    };\n    ResourcesLeftPanel.prototype.resize = function () {\n        _super.prototype.resize.call(this);\n        this.$views.height(this.$main.height());\n        this.$resources.height(this.$main.height());\n    };\n    return ResourcesLeftPanel;\n}(LeftPanel));\nexport { ResourcesLeftPanel };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ThumbsView as BaseView } from \"../uv-shared-module/ThumbsView\";\nvar ThumbsView = /** @class */ (function (_super) {\n    __extends(ThumbsView, _super);\n    function ThumbsView() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ThumbsView.prototype.create = function () {\n        this.setConfig(\"resourcesLeftPanel\");\n        _super.prototype.create.call(this);\n    };\n    return ThumbsView;\n}(BaseView));\nexport { ThumbsView };\n"],"sourceRoot":""}